<!DOCRTYPE html>
<html>
	<head>
	<meta charset="utf-8">
	<title>Add Carer</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	
	<nav class="navbar navbar-default">
			<div class="container-fluid">
				<div class="navbar-header">
					<a class="navbar-brand" href="#">VCA</a>
				</div>
				<ul class="nav navbar-nav">
					<li class="active"><a href="HomePage.html">Home</a></li>
					<li class ="active"><a href="allPatients.html">View Patients</a></li>
					<li class ="active"><a href="allCarers.html">View Carers</a></li>
					<li class ="active"><a href="addCarer.html">Create Carer</a></li>
					<li class ="active"><a href="UpdateValues.html">Update Values</a></li>
				</ul>
				
				<ul class="nav navbar-nav navbar-right">
					<form class="navbar-form" role="search">
						<div class="input-group">
							<input type="text" class="form-control" placeholder="Search" name="srch-term" id="srch-term">
							<div class="input-group-btn">
								<button class="btn btn-default" type="submit"><i class="glyphicon glyphicon-search"></i></button>
							</div>
						</div>
					</form>
				</ul>	
			</div>
		</nav>
	
	</head>
	<body>
		<div class="container">
			<!-- The h1 "testData" changes based on the "text" field in the database -->
			<h1 id = "testData"></h1>
			<h2>Carer Account Creation</h2>
			
			<div class="page-header">
			
			</div>
			<div class="jumbotron">

				
				<!--The button calls the "update" function. The names in the form are uploaded to the database. -->
				<form class="form1">
				  Name: <input type="text" id="name"><br>
				  Phone Number: <input type="number" id="phone"><br>
				  Email:	<input type="email" id="email"><br>
				  Password: <input type="password" id="password"><br>
				  Geotagging: <input type="radio" name="test" id="geo" value="yes"> Yes 
				  <input type="radio" name="test" id="geo" value="no"> No<br> 
				  <br>
				  <button id="formButton" class="btn btn-default" onclick="update()">Submit</button>
				</form>
				
			</div>
		</div>
		<script src="https://cdn.firebase.com/js/client/2.4.2/firebase.js"></script>
		<script>
			var dataRef = new Firebase('https://rd-year-group-project.firebaseio.com');
			
			// Save data to firebase
			function update(){
			
			var name = document.getElementById("name").value;
            var email = document.getElementById("email").value;
			var phone = document.getElementById("phone").value;
            var password = document.getElementById("password").value;
			var geo = document.getElementById("geo").value;
			var carerID = 'InitialValue';
			var tableRef = dataRef.child("users/Carers").ref();
			// Retrieve new posts as they are added to our database
			tableRef.on("child_added", function(snapshot) {
				console.log('Test');
				snapshot.forEach(function(childSnapshot, prevChildKey) {
					var childData = childSnapshot.key();
					childData = prevChildData.key();
					var username = 'users/Carers/' + childData + 1;  
						
					dataRef.child(username).set({
                    email: email,
                    password: password,
					name: name,
					phone: phone,
					geo: geo
                });
					
					var test = childData.split("Carer");
					var test2 = test[0];
					console.log('Tas');
					var username = 'users/Carers/' + carerID + 1;  
					
    });
});
   

			//var split = carerID.split("Carer");
			//var id = split[1];
			//var carer = 'Carer' + id;
			var username = 'users/Carers/' + carerID + 1;  

			dataRef.child(username).set({
                    email: email,
                    password: password,
					name: name,
					phone: phone,
					geo: geo
                });
}		
			
		</script>
		<!--
		The following code is not implemented yet but will be helpful for logging in
		// For user authentication
		function authHandler(error, authData) {
		if (error) {
		console.log('Login Failed!', error);
		} else {
		}
		}

		// Log the user in with an email combination
		dataRef.authWithPassword({
			email    : 'mail@mail.com',
			password : 'pass'
			}, authHandler);

		dataRef.onAuth(function(authData) {
		userId = authData.uid;
		});
		-->
		
	</body>
</html>

